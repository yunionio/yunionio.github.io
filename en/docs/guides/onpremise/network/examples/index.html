<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/onpremise/network/examples" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Typical Network Configuration | Cloudpods</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.cloudpods.org/en/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://www.cloudpods.org/en/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://www.cloudpods.org/en/docs/guides/onpremise/network/examples"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" property="og:locale:alternate" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Typical Network Configuration | Cloudpods"><meta data-rh="true" name="description" content="This article introduces several typical private cloud network configurations."><meta data-rh="true" property="og:description" content="This article introduces several typical private cloud network configurations."><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.cloudpods.org/en/docs/guides/onpremise/network/examples"><link data-rh="true" rel="alternate" href="https://www.cloudpods.org/docs/guides/onpremise/network/examples" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://www.cloudpods.org/en/docs/guides/onpremise/network/examples" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.cloudpods.org/docs/guides/onpremise/network/examples" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="Cloudpods RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="Cloudpods Atom Feed">



<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-999X9XX9XX"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-999X9XX9XX",{anonymize_ip:!0})</script>

<script src="https://hm.baidu.com/hm.js?3c5253cd6530122d0f774cab69e3c07f" async></script>
<script src="/js/github-star.js" async></script><link rel="stylesheet" href="/en/assets/css/styles.bf8d0121.css">
<script src="/en/assets/js/runtime~main.c8aa0ee0.js" defer="defer"></script>
<script src="/en/assets/js/main.70951eff.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/cloudpods_circle_black.svg" alt="Cloudpods Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/en/img/cloudpods_circle_white.svg" alt="Cloudpods Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Cloudpods</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/en/docs/introduction/">Docs</a><a class="navbar__item navbar__link" href="/en/blog">Blog</a><a href="https://www.yunion.cn/subscription/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Subscription</a><a href="https://apifox.com/apidoc/shared-f917f6a6-db9f-4d6a-bbc3-ea58c945d7fd" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/en/docs/introduction/">3.11</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/en/docs/guides/onpremise/network/examples">3.11</a></li><li><a href="https://www.cloudpods.org/v3.10/" target="_blank" rel="noopener noreferrer" class="dropdown__link">3.10<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://v1.cloudpods.org/v3.9/" target="_blank" rel="noopener noreferrer" class="dropdown__link">3.9<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" href="/en/docs/guides/onpremise/network/examples"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/guides/onpremise/network/examples" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">简体中文</a></li><li><a href="/en/docs/guides/onpremise/network/examples" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li></ul></div><a href="https://github.com/yunionio/cloudpods" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link GitHubLink-custom">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/en/docs/introduction/">Introduction</a><button aria-label="Expand sidebar category &#x27;Introduction&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/en/docs/getting-started/">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/en/docs/guides/">User Guides</a><button aria-label="Collapse sidebar category &#x27;User Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/climc/">命令行工具</a><button aria-label="Expand sidebar category &#x27;命令行工具&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/en/docs/guides/onpremise/">Private Cloud</a><button aria-label="Collapse sidebar category &#x27;Private Cloud&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/onpremise/vminstance/">虚拟机</a><button aria-label="Expand sidebar category &#x27;虚拟机&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/onpremise/glance/">镜像模板</a><button aria-label="Expand sidebar category &#x27;镜像模板&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/onpremise/host/">宿主机</a><button aria-label="Expand sidebar category &#x27;宿主机&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/onpremise/baremetal/">物理机</a><button aria-label="Expand sidebar category &#x27;物理机&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/onpremise/storage/">存储</a><button aria-label="Expand sidebar category &#x27;存储&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/onpremise/lb/">负载均衡</a><button aria-label="Expand sidebar category &#x27;负载均衡&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/onpremise/scheduler/">资源调度</a><button aria-label="Expand sidebar category &#x27;资源调度&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/en/docs/guides/onpremise/network/">Network</a><button aria-label="Collapse sidebar category &#x27;Network&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/guides/onpremise/network/host">宿主机网络</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/guides/onpremise/network/baremetal">裸金属网络</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/onpremise/network/vpc/">VPC网络</a><button aria-label="Expand sidebar category &#x27;VPC网络&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/guides/onpremise/network/dns">虚拟机域名设置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/guides/onpremise/network/replacewire">更改宿主机网卡接入的二层网络</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/guides/onpremise/network/addnetwork">添加宿主机网络</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/guides/onpremise/network/multiqueue">虚拟机网卡多队列</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/guides/onpremise/network/configuration">网络参数配置</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/guides/onpremise/network/mirror">流量镜像</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/guides/onpremise/network/traffic_limit">网卡流量限制</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/guides/onpremise/network/reservedip">IP预留</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/guides/onpremise/network/subips">网卡附属IP(SubIPs)</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/onpremise/network/ssh/">SSH 代理服务</a><button aria-label="Expand sidebar category &#x27;SSH 代理服务&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/guides/onpremise/network/examples">Typical Network Configuration</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/cmp/">多云管理</a><button aria-label="Expand sidebar category &#x27;多云管理&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/auth_security/">认证与权限</a><button aria-label="Expand sidebar category &#x27;认证与权限&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/k8s/">Kubernetes 管理</a><button aria-label="Expand sidebar category &#x27;Kubernetes 管理&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/monitor_ops/">监控与运维</a><button aria-label="Expand sidebar category &#x27;监控与运维&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/en/docs/guides/misc/">其他功能</a><button aria-label="Expand sidebar category &#x27;其他功能&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/en/docs/operations/">Operations</a><button aria-label="Expand sidebar category &#x27;Operations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/en/docs/development/">Development</a><button aria-label="Expand sidebar category &#x27;Development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/en/docs/release-notes/">Release Notes</a><button aria-label="Expand sidebar category &#x27;Release Notes&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/contact/">Contact US</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/en/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/en/docs/guides/"><span itemprop="name">User Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/en/docs/guides/onpremise/"><span itemprop="name">Private Cloud</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/en/docs/guides/onpremise/network/"><span itemprop="name">Network</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Typical Network Configuration</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Typical Network Configuration</h1>
<p>This article introduces several typical private cloud network configurations.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="single-nic-classic-network-computing-node-single-nic-virtual-machine-using-multi-vlan-classic-network">(Single NIC Classic Network) computing node single NIC, virtual machine using Multi-VLAN classic network<a class="hash-link" aria-label="Direct link to (Single NIC Classic Network) computing node single NIC, virtual machine using Multi-VLAN classic network" title="Direct link to (Single NIC Classic Network) computing node single NIC, virtual machine using Multi-VLAN classic network" href="/en/docs/guides/onpremise/network/examples#single-nic-classic-network-computing-node-single-nic-virtual-machine-using-multi-vlan-classic-network">​</a></h2>
<p>In this scenario, each computing node only has one NIC (which can be Bonding) that serves both as a management port and a business port. The business traffic between virtual machines is forwarded by the host to the Layer 3 switch.</p>
<!-- -->
<img src="/en/assets/images/singleport-0a498050c1c38f46f755af5b3ca2eb73.png" width="400">
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="vpc-configuration">VPC Configuration<a class="hash-link" aria-label="Direct link to VPC Configuration" title="Direct link to VPC Configuration" href="/en/docs/guides/onpremise/network/examples#vpc-configuration">​</a></h3>
<p>Use <em>Default</em> VPC.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="layer-2-network-configuration">Layer-2 Network Configuration<a class="hash-link" aria-label="Direct link to Layer-2 Network Configuration" title="Direct link to Layer-2 Network Configuration" href="/en/docs/guides/onpremise/network/examples#layer-2-network-configuration">​</a></h3>
<p>Create a layer-2 network <em>bcast0</em> in <em>Default</em> VPC.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ip-subnet-configuration">IP Subnet Configuration<a class="hash-link" aria-label="Direct link to IP Subnet Configuration" title="Direct link to IP Subnet Configuration" href="/en/docs/guides/onpremise/network/examples#ip-subnet-configuration">​</a></h3>
<p>Create at least 2 IP subnets in the layer-2 network <em>bcast0</em>, one of which is used for the host management port and needs to include the IP of the host management port. The other subnet is used for the virtual machine. More IP subnets can be configured for virtual machines, and these virtual machines can be configured with different VLAN IDs (VLAN IDs other than 1). The gateway and corresponding VLAN of these IP subnets need to be configured on the Layer 3 switch connected to the physical machine.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="host-configuration">Host Configuration<a class="hash-link" aria-label="Direct link to Host Configuration" title="Direct link to Host Configuration" href="/en/docs/guides/onpremise/network/examples#host-configuration">​</a></h3>
<p>The host port on the switch needs to be configured in trunk mode, and the <em>default</em> VLAN ID must be used for the host management port. By default, the VLAN ID is 1. But currently, the switch also supports setting a VLAN ID other than 1 for the TRUNK port. Please refer to the switch configuration manual for details.</p>
<p>The networks configuration of the host.conf file:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> &lt;host_ifname</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain">/br0/&lt;host_management_ip</span><span class="token punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For example:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth0/br0/10.168.20.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-configure-if-the-host-management-port-uses-a-vlan-id-other-than-1-and-the-switch-does-not-support-setting-the-default-vlan-id-for-trunk-port">How to configure if the host management port uses a VLAN ID other than 1 and the switch does not support setting the default VLAN ID for TRUNK port?<a class="hash-link" aria-label="Direct link to How to configure if the host management port uses a VLAN ID other than 1 and the switch does not support setting the default VLAN ID for TRUNK port?" title="Direct link to How to configure if the host management port uses a VLAN ID other than 1 and the switch does not support setting the default VLAN ID for TRUNK port?" href="/en/docs/guides/onpremise/network/examples#how-to-configure-if-the-host-management-port-uses-a-vlan-id-other-than-1-and-the-switch-does-not-support-setting-the-default-vlan-id-for-trunk-port">​</a></h4>
<!-- -->
<img src="/en/assets/images/singleportvlan-02d382cc004177a0739d00ced2766454.png" width="400">
<p>A VLAN subinterface needs to be set up for the host, and the host uses this VLAN subinterface as the management port, and the virtual machine switch needs to be bridged to the main interface. Take the host main interface bond0 and the VLAN ID of the host management port 3001 as an example:</p>
<ol>
<li>Configure VLAN subinterface bond0.3001 for the host, as follows:</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># /etc/sysconfig/network-scripts/ifcfg-bond0.3001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">VLAN</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">bond0.3001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DEVICE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">bond0.3001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">IPADDR</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">management_ip</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PREFIX</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">prefix</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DEFROUTE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">ONBOOT</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>Modify /etc/yunion/host.conf and set it as follows:</li>
</ol>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">listen_interface</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> bond0.3001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> bond0/br0/bcast0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note that in this configuration, virtual machines cannot use the same VLAN ID as the host (in this case, 3001).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="eip-configuration">EIP Configuration<a class="hash-link" aria-label="Direct link to EIP Configuration" title="Direct link to EIP Configuration" href="/en/docs/guides/onpremise/network/examples#eip-configuration">​</a></h3>
<p>In classic network mode, external entities can directly access virtual machine IPs without configuring EIP.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="single-nic-vpc-network-computing-node-single-nic-virtual-machine-using-vpc-network">(Single NIC VPC Network) computing node single NIC, virtual machine using VPC network<a class="hash-link" aria-label="Direct link to (Single NIC VPC Network) computing node single NIC, virtual machine using VPC network" title="Direct link to (Single NIC VPC Network) computing node single NIC, virtual machine using VPC network" href="/en/docs/guides/onpremise/network/examples#single-nic-vpc-network-computing-node-single-nic-virtual-machine-using-vpc-network">​</a></h2>
<p>In this scenario, each computing node host has only one NIC as the management port. The management port also carries business traffic, but the business traffic between virtual machines is encapsulated by the OVN Geneve tunnel.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="host-network-configuration">Host Network Configuration<a class="hash-link" aria-label="Direct link to Host Network Configuration" title="Direct link to Host Network Configuration" href="/en/docs/guides/onpremise/network/examples#host-network-configuration">​</a></h3>
<p>The host&#x27;s management port still accesses the classic network.</p>
<p>Create a layer-2 network <em>bcast0</em> in <em>Default</em> VPC, and in this layer-2 network, configure the IP subnet used by the host management port.</p>
<p>The host.conf networks configuration is the same as the <em>Single NIC Classic Network</em> mode.</p>
<p>For example, if the host IP subnet is 10.128.26.2, the configuration is also:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth0/br0/10.128.26.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="virtual-machine-network-configuration">Virtual Machine Network Configuration<a class="hash-link" aria-label="Direct link to Virtual Machine Network Configuration" title="Direct link to Virtual Machine Network Configuration" href="/en/docs/guides/onpremise/network/examples#virtual-machine-network-configuration">​</a></h3>
<p>The virtual machine&#x27;s network is managed by VPC. Users can create any VPC and allocate any IP subnet in the VPC. IP subnets between different VPCs are isolated from each other and cannot be accessed. IP subnets within the same VPC are not isolated from each other.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="eip-configuration-1">EIP Configuration<a class="hash-link" aria-label="Direct link to EIP Configuration" title="Direct link to EIP Configuration" href="/en/docs/guides/onpremise/network/examples#eip-configuration-1">​</a></h3>
<p>In this mode, EIP needs to be configured to access virtual machines in the VPC from outside the cloud platform.</p>
<p>The simplest EIP configuration is to select a host, modify /etc/yunion/host.conf, and set sdn_enable_eip_man to true. For more specific configuration methods, please refer to the documentation. The first host installed in the ALL IN ONE mode automatically enables sdn_enable_eip_man.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="eip-gateway-routing-configurationto-use-eip-you-also-need-to-add-an-ip-subnet-for-eip-under-the-platform-bcast0-note-that-the-eip-subnet-should-avoid-being-in-the-same-subnet-as-the-hosts-management-ip-that-is-the-network-address-needs-to-be-different-for-example-if-the-hosts-management-nic-is-1016822224-then-the-eip-subnet-is-1016823024-add-a-static-route-for-the-eip-subnet-on-the-switch-with-the-nexthop-set-to-the-management-port-ip-address-of-the-first-host-in-the-all-in-one-deployment">EIP Gateway Routing ConfigurationTo use EIP, you also need to add an IP subnet for EIP under the platform bcast0 (Note that the EIP subnet should avoid being in the same subnet as the host&#x27;s management IP, that is, the network address needs to be different. For example, if the host&#x27;s management NIC is 10.168.22.2/24, then the EIP subnet is 10.168.23.0/24). Add a static route for the EIP subnet on the switch, with the NextHop set to the management port IP address of the first host in the ALL IN ONE deployment.<a class="hash-link" aria-label="Direct link to EIP Gateway Routing ConfigurationTo use EIP, you also need to add an IP subnet for EIP under the platform bcast0 (Note that the EIP subnet should avoid being in the same subnet as the host&#x27;s management IP, that is, the network address needs to be different. For example, if the host&#x27;s management NIC is 10.168.22.2/24, then the EIP subnet is 10.168.23.0/24). Add a static route for the EIP subnet on the switch, with the NextHop set to the management port IP address of the first host in the ALL IN ONE deployment." title="Direct link to EIP Gateway Routing ConfigurationTo use EIP, you also need to add an IP subnet for EIP under the platform bcast0 (Note that the EIP subnet should avoid being in the same subnet as the host&#x27;s management IP, that is, the network address needs to be different. For example, if the host&#x27;s management NIC is 10.168.22.2/24, then the EIP subnet is 10.168.23.0/24). Add a static route for the EIP subnet on the switch, with the NextHop set to the management port IP address of the first host in the ALL IN ONE deployment." href="/en/docs/guides/onpremise/network/examples#eip-gateway-routing-configurationto-use-eip-you-also-need-to-add-an-ip-subnet-for-eip-under-the-platform-bcast0-note-that-the-eip-subnet-should-avoid-being-in-the-same-subnet-as-the-hosts-management-ip-that-is-the-network-address-needs-to-be-different-for-example-if-the-hosts-management-nic-is-1016822224-then-the-eip-subnet-is-1016823024-add-a-static-route-for-the-eip-subnet-on-the-switch-with-the-nexthop-set-to-the-management-port-ip-address-of-the-first-host-in-the-all-in-one-deployment">​</a></h4>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dual-nic-classic-network-compute-node-with-two-nics-virtual-machines-use-multi-vlan-classic-network">(Dual NIC Classic Network) Compute node with two NICs, virtual machines use Multi-VLAN Classic Network<a class="hash-link" aria-label="Direct link to (Dual NIC Classic Network) Compute node with two NICs, virtual machines use Multi-VLAN Classic Network" title="Direct link to (Dual NIC Classic Network) Compute node with two NICs, virtual machines use Multi-VLAN Classic Network" href="/en/docs/guides/onpremise/network/examples#dual-nic-classic-network-compute-node-with-two-nics-virtual-machines-use-multi-vlan-classic-network">​</a></h2>
<p>In this scenario, each compute node has two NICs, one for management and the other for business. Business traffic between virtual machines is forwarded by a Layer 3 switch that connects to the host&#x27;s business NIC. However, some virtual machines need to connect to the management NIC.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="vpc-configuration-1">VPC Configuration<a class="hash-link" aria-label="Direct link to VPC Configuration" title="Direct link to VPC Configuration" href="/en/docs/guides/onpremise/network/examples#vpc-configuration-1">​</a></h3>
<p>Use the Default VPC.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="layer-2-network-configuration-1">Layer-2 Network Configuration<a class="hash-link" aria-label="Direct link to Layer-2 Network Configuration" title="Direct link to Layer-2 Network Configuration" href="/en/docs/guides/onpremise/network/examples#layer-2-network-configuration-1">​</a></h3>
<p>Create two Layer-2 networks in the Default VPC: bcast0 (management) and bcast1 (business).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ip-subnet-configuration-1">IP Subnet Configuration<a class="hash-link" aria-label="Direct link to IP Subnet Configuration" title="Direct link to IP Subnet Configuration" href="/en/docs/guides/onpremise/network/examples#ip-subnet-configuration-1">​</a></h3>
<p>Create at least two IP subnets on bcast0, with one IP subnet used for the host&#x27;s management NIC, which needs to include the host&#x27;s management NIC IP address. The other subnet is used for virtual machines that require a connection to the management network.</p>
<p>Create 1 or more IP subnets on bcast1 for virtual machine use, and these subnets can be configured with different VLAN IDs (VLAN ID other than 1). The gateways and corresponding VLANs for these subnets need to be configured on the corresponding Layer 3 switches connected to the physical machine.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="host-configuration-1">Host Configuration<a class="hash-link" aria-label="Direct link to Host Configuration" title="Direct link to Host Configuration" href="/en/docs/guides/onpremise/network/examples#host-configuration-1">​</a></h3>
<p>The host&#x27;s management NIC needs to be configured with a management IP address and set to Access mode on the switch.</p>
<p>The host&#x27;s business NIC does not need to be configured with an IP address, but the business NIC needs to be configured in Trunk mode on the switch.</p>
<p>The host&#x27;s /etc/yunion/host.conf file needs to have two entries, one for the management NIC and one for the business NIC:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> &lt;host_ifname0</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain">/br0/&lt;host_management_ip</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> &lt;host_ifname1</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain">/br1/bcast1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For example:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth0/br0/10.168.20.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth1/br1/bcast1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="eip-configuration-2">EIP Configuration<a class="hash-link" aria-label="Direct link to EIP Configuration" title="Direct link to EIP Configuration" href="/en/docs/guides/onpremise/network/examples#eip-configuration-2">​</a></h3>
<p>In this mode, virtual machines&#x27; IPs can be directly accessed from the outside without the need to configure EIP.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dual-nic-vpc-network-compute-node-with-two-nics-virtual-machines-use-vpc-network">(Dual NIC VPC Network) Compute node with two NICs, virtual machines use VPC Network<a class="hash-link" aria-label="Direct link to (Dual NIC VPC Network) Compute node with two NICs, virtual machines use VPC Network" title="Direct link to (Dual NIC VPC Network) Compute node with two NICs, virtual machines use VPC Network" href="/en/docs/guides/onpremise/network/examples#dual-nic-vpc-network-compute-node-with-two-nics-virtual-machines-use-vpc-network">​</a></h2>
<p>In this scenario, each compute node&#x27;s host has two NICs: one for management, which carries management traffic, and another for business, which carries business traffic. Business traffic between virtual machines is encapsulated in an ovn-geneve tunnel, and then forwarded through the host&#x27;s business NIC.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="host-network-configuration-1">Host Network Configuration<a class="hash-link" aria-label="Direct link to Host Network Configuration" title="Direct link to Host Network Configuration" href="/en/docs/guides/onpremise/network/examples#host-network-configuration-1">​</a></h3>
<p>Similarly, the host&#x27;s management NIC uses a classic network. You need to configure a Layer-2 network bcast0 under Default VPC, and configure the IP subnet used by the host&#x27;s management NIC under that Layer-2 network.</p>
<p>For example, the host&#x27;s IP subnet is 10.128.26.2. The host&#x27;s /etc/yunion/host.conf configuration should be:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth0/br0/10.128.26.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Also, the host&#x27;s business NIC needs to be configured with an IP address, and the IP used by the business NIC should not be in the same Layer-2 network as the IP used by the management NIC.</p>
<p>To ensure ovn traffic between virtual machines is forwarded through the business NIC, you need to configure the ovn_encap_ip in /etc/yunion/host.conf to the IP address of the host&#x27;s business NIC.</p>
<p>For example, if the host&#x27;s management NIC IP is 10.128.26.2/24 and the business NIC IP is 10.129.26.2/24, the /etc/yunion/host.conf file should be configured as follows:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">ovn_encap_ip</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 10.129.26.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">networks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth0/br0/10.128.26.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> eth1/br1/10.129.26.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After the configuration is complete, ovn traffic between virtual machines will be encapsulated as geneve traffic, with source and destination IP addresses being in the business network range. Network intercommunication between business NICs is not affected by business NIC VLAN mode, whether TRUNK or Access.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="virtual-machine-network-configuration-1">Virtual Machine Network Configuration<a class="hash-link" aria-label="Direct link to Virtual Machine Network Configuration" title="Direct link to Virtual Machine Network Configuration" href="/en/docs/guides/onpremise/network/examples#virtual-machine-network-configuration-1">​</a></h3>
<p>Similarly, in this mode, the virtual machine network is managed by the VPC Network, and users can create VPCs and assign any IP subnet in VPC. IP subnets between different VPCs are isolated and cannot be accessed. IP subnets in the same VPC are not isolated. As the ovn_encap_ip is configured to the host&#x27;s business NIC IP address, ovn traffic between virtual machines is forwarded through the host&#x27;s business NIC.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="eip-configuration-3">EIP Configuration<a class="hash-link" aria-label="Direct link to EIP Configuration" title="Direct link to EIP Configuration" href="/en/docs/guides/onpremise/network/examples#eip-configuration-3">​</a></h3>
<p>In VPC network mode, you need to configure EIP for external access to specific internal virtual machines. Similarly, EIP gateway and subnet need to be configured.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="eip-gateway-routing-configuration">EIP Gateway Routing Configuration<a class="hash-link" aria-label="Direct link to EIP Gateway Routing Configuration" title="Direct link to EIP Gateway Routing Configuration" href="/en/docs/guides/onpremise/network/examples#eip-gateway-routing-configuration">​</a></h4>
<p>Unlike the Single NIC VPC Network case, in order to ensure EIP traffic also passes through the business NIC, the following two configurations need to be met:</p>
<p>When configuring NextHop for the EIP subnet, on the switch, it is necessary to use the IP address of the node&#x27;s business NIC on which the EIP gateway is located as the NextHop IP (to ensure that the incoming traffic to the EIP traffic goes through the business NIC).* On the node where the EIP gateway is located, the business port needs to be set as the default route for outbound traffic. (Ensure that the traffic flowing out of the EIP goes through the business port)</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/yunionio/website/tree/master/docs/guides/onpremise/network/examples.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/en/docs/guides/onpremise/network/ssh/sshagent"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">SSH代理服务</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/en/docs/guides/cmp/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">多云管理</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#single-nic-classic-network-computing-node-single-nic-virtual-machine-using-multi-vlan-classic-network">(Single NIC Classic Network) computing node single NIC, virtual machine using Multi-VLAN classic network</a><ul><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#vpc-configuration">VPC Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#layer-2-network-configuration">Layer-2 Network Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#ip-subnet-configuration">IP Subnet Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#host-configuration">Host Configuration</a><ul><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#how-to-configure-if-the-host-management-port-uses-a-vlan-id-other-than-1-and-the-switch-does-not-support-setting-the-default-vlan-id-for-trunk-port">How to configure if the host management port uses a VLAN ID other than 1 and the switch does not support setting the default VLAN ID for TRUNK port?</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#eip-configuration">EIP Configuration</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#single-nic-vpc-network-computing-node-single-nic-virtual-machine-using-vpc-network">(Single NIC VPC Network) computing node single NIC, virtual machine using VPC network</a><ul><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#host-network-configuration">Host Network Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#virtual-machine-network-configuration">Virtual Machine Network Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#eip-configuration-1">EIP Configuration</a><ul><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#eip-gateway-routing-configurationto-use-eip-you-also-need-to-add-an-ip-subnet-for-eip-under-the-platform-bcast0-note-that-the-eip-subnet-should-avoid-being-in-the-same-subnet-as-the-hosts-management-ip-that-is-the-network-address-needs-to-be-different-for-example-if-the-hosts-management-nic-is-1016822224-then-the-eip-subnet-is-1016823024-add-a-static-route-for-the-eip-subnet-on-the-switch-with-the-nexthop-set-to-the-management-port-ip-address-of-the-first-host-in-the-all-in-one-deployment">EIP Gateway Routing ConfigurationTo use EIP, you also need to add an IP subnet for EIP under the platform bcast0 (Note that the EIP subnet should avoid being in the same subnet as the host&#39;s management IP, that is, the network address needs to be different. For example, if the host&#39;s management NIC is 10.168.22.2/24, then the EIP subnet is 10.168.23.0/24). Add a static route for the EIP subnet on the switch, with the NextHop set to the management port IP address of the first host in the ALL IN ONE deployment.</a></li></ul></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#dual-nic-classic-network-compute-node-with-two-nics-virtual-machines-use-multi-vlan-classic-network">(Dual NIC Classic Network) Compute node with two NICs, virtual machines use Multi-VLAN Classic Network</a><ul><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#vpc-configuration-1">VPC Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#layer-2-network-configuration-1">Layer-2 Network Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#ip-subnet-configuration-1">IP Subnet Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#host-configuration-1">Host Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#eip-configuration-2">EIP Configuration</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#dual-nic-vpc-network-compute-node-with-two-nics-virtual-machines-use-vpc-network">(Dual NIC VPC Network) Compute node with two NICs, virtual machines use VPC Network</a><ul><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#host-network-configuration-1">Host Network Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#virtual-machine-network-configuration-1">Virtual Machine Network Configuration</a></li><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#eip-configuration-3">EIP Configuration</a><ul><li><a class="table-of-contents__link toc-highlight" href="/en/docs/guides/onpremise/network/examples#eip-gateway-routing-configuration">EIP Gateway Routing Configuration</a></li></ul></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>